{"ast":null,"code":"import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-646f65ac\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"main-container box-shadow\"\n};\nconst _hoisted_2 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h4\", {\n  class: \"payment-title text-melon\"\n}, \"카드 등록 중...\", -1));\nconst _hoisted_3 = {\n  key: 0\n};\nconst _hoisted_4 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"p\", null, \"카드를 등록하는 중입니다. 잠시만 기다려주세요...\", -1));\nconst _hoisted_5 = [_hoisted_4];\nconst _hoisted_6 = {\n  key: 1\n};\nconst _hoisted_7 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"p\", null, \"카드가 성공적으로 등록되었습니다.\", -1));\nconst _hoisted_8 = {\n  key: 2\n};\nconst _hoisted_9 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"p\", null, \"카드 등록에 실패했습니다. 다시 시도해주세요.\", -1));\nconst _hoisted_10 = [_hoisted_9];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_hoisted_2, $data.loading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, _hoisted_5)) : $data.billingKey ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [_hoisted_7, _createElementVNode(\"button\", {\n    onClick: _cache[0] || (_cache[0] = (...args) => $options.goToApprovePayment && $options.goToApprovePayment(...args)),\n    class: \"btn btn-green\"\n  }, \"결제 요청 페이지로 이동\")])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_8, _hoisted_10))]);\n}","map":{"version":3,"names":["class","_createElementVNode","key","_hoisted_4","_hoisted_9","_createElementBlock","_hoisted_1","_hoisted_2","$data","loading","_hoisted_3","_hoisted_5","billingKey","_hoisted_6","_hoisted_7","onClick","_cache","args","$options","goToApprovePayment","_hoisted_8","_hoisted_10"],"sources":["C:\\Users\\woori\\IdeaProjects\\pillgood_v2\\src\\frontend\\src\\views\\CardRegistration.vue"],"sourcesContent":["<template>\n  <div class=\"main-container box-shadow\">\n    <h4 class=\"payment-title text-melon\">카드 등록 중...</h4>\n    <div v-if=\"loading\">\n      <p>카드를 등록하는 중입니다. 잠시만 기다려주세요...</p>\n    </div>\n    <div v-else-if=\"billingKey\">\n      <p>카드가 성공적으로 등록되었습니다.</p>\n      <button @click=\"goToApprovePayment\" class=\"btn btn-green\">결제 요청 페이지로 이동</button>\n    </div>\n    <div v-else>\n      <p>카드 등록에 실패했습니다. 다시 시도해주세요.</p>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapState, mapActions } from 'vuex';\nimport axios from 'axios';\n\nexport default {\n  name: 'CardRegistration',\n  data() {\n    return {\n      customerKey: null,\n      authKey: null,\n      billingKey: null,\n      loading: true,\n    };\n  },\n  computed: {\n    ...mapState('order', {\n      user: state => state.userProfile,\n    })\n  },\n  async created() {\n    await this.fetchUserProfile(); // 사용자 정보를 가져옵니다.\n    this.loading = false;\n    const urlParams = new URLSearchParams(window.location.search);\n    this.customerKey = urlParams.get('customerKey');\n    this.authKey = urlParams.get('authKey');\n\n    if (this.customerKey && this.authKey) {\n      try {\n        // billing key 발급\n        const billingResponse = await axios.post('/api/payment/issue-billing-key', {\n          customerKey: this.customerKey,\n          authKey: this.authKey\n        });\n        if (billingResponse.data && billingResponse.data.billingKey) {\n          this.billingKey = billingResponse.data.billingKey;\n          this.$store.commit('billing/setBillingKey', this.billingKey);\n        } else {\n          console.error('Billing key 발급 실패:', billingResponse);\n        }\n      } catch (error) {\n        console.error('Billing key 발급 중 오류 발생:', error);\n      }\n    }\n  },\n  methods: {\n    ...mapActions('order', ['fetchUserProfile']),\n    goToApprovePayment() {\n      this.$router.push({ name: 'ApprovePayment' });\n    }\n  }\n};\n</script>\n\n<style scoped>\n.main-container {\n  max-width: 600px;\n  margin: 0 auto;\n  padding: 20px;\n  background-color: #fff;\n  border-radius: 8px;\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);\n}\n\n.payment-title {\n  font-size: 1.5rem;\n  font-weight: bold;\n  margin-bottom: 20px;\n}\n\n.btn {\n  display: block;\n  width: 100%;\n  padding: 10px;\n  background-color: #5cb85c;\n  color: white;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 1.2rem;\n  text-align: center;\n}\n\n.btn:hover {\n  background-color: #4cae4c;\n}\n\n.loading {\n  font-size: 1.2rem;\n  text-align: center;\n  margin-top: 20px;\n}\n</style>\n"],"mappings":";;;EACOA,KAAK,EAAC;AAA2B;gEACpCC,mBAAA,CAAoD;EAAhDD,KAAK,EAAC;AAA0B,GAAC,YAAU;;EAFnDE,GAAA;AAAA;gEAIMD,mBAAA,CAAmC,WAAhC,8BAA4B;oBAA/BE,UAAmC,C;;EAJzCD,GAAA;AAAA;gEAOMD,mBAAA,CAAyB,WAAtB,oBAAkB;;EAP3BC,GAAA;AAAA;gEAWMD,mBAAA,CAAgC,WAA7B,2BAAyB;qBAA5BG,UAAgC,C;;uBAVpCC,mBAAA,CAYM,OAZNC,UAYM,GAXJC,UAAoD,EACzCC,KAAA,CAAAC,OAAO,I,cAAlBJ,mBAAA,CAEM,OALVK,UAAA,EAAAC,UAAA,KAMoBH,KAAA,CAAAI,UAAU,I,cAA1BP,mBAAA,CAGM,OATVQ,UAAA,GAOMC,UAAyB,EACzBb,mBAAA,CAAgF;IAAvEc,OAAK,EAAAC,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEC,QAAA,CAAAC,kBAAA,IAAAD,QAAA,CAAAC,kBAAA,IAAAF,IAAA,CAAkB;IAAEjB,KAAK,EAAC;KAAgB,eAAa,E,oBAEzEK,mBAAA,CAEM,OAZVe,UAAA,EAAAC,WAAA,G","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}